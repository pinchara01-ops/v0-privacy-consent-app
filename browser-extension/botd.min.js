var Botd = function (t) { "use strict"; function n(t, n, e, r) { return new (e || (e = Promise))((function (o, i) { function u(t) { try { c(r.next(t)) } catch (n) { i(n) } } function s(t) { try { c(r.throw(t)) } catch (n) { i(n) } } function c(t) { var n; t.done ? o(t.value) : (n = t.value, n instanceof e ? n : new e((function (t) { t(n) }))).then(u, s) } c((r = r.apply(t, n || [])).next()) })) } function e(t) { return n(this, void 0, void 0, (function* () { let n, e; try { n = yield t(), e = { state: 1, value: n } } catch (r) { e = { state: -1, value: r.toString() } } return e })) } function r() { return navigator.userAgent } function o() { return void 0 !== navigator.userAgentData } function i() { return navigator.appVersion } function u() { if (void 0 === navigator.connection) throw new Error("undefined"); return navigator.connection.rtt } function s() { return [window.outerWidth, window.outerHeight] } function c() { return n(this, void 0, void 0, (function* () { if ("undefined" == typeof Notification) throw new Error("Notification is undefined"); const { permissions: t } = navigator; if (!t) throw new Error("navigator.permissions is undefined"); const n = yield t.query({ name: "notifications" }); return "denied" === Notification.permission && "prompt" === n.state })) } function a() { const t = document.createElement("canvas").getContext("webgl"); if (null !== t) { const n = t.getExtension("WEBGL_debug_renderer_info"); if (null !== n) { return [t.getParameter(n.UNMASKED_VENDOR_WEBGL), t.getParameter(n.UNMASKED_RENDERER_WEBGL)] } } throw new Error("can`t get webgl data") } function d() { return [screen.width, screen.height] } function f() { if (void 0 === navigator.deviceMemory) throw new Error("undefined"); return navigator.deviceMemory } function g() { const t = new ArrayBuffer(4); return new Uint32Array(t)[0] = 2852126720, 170 === new Uint8Array(t)[0] } function h() { try { const t = navigator.hardwareConcurrency; if ("string" == typeof t) { const n = parseInt(t); return isNaN(n) ? 1 : n } return t } catch (t) { throw new Error("wrong type") } } function l() { return eval.toString().length } function v() { return navigator.plugins.length } function p() { return n(this, void 0, void 0, (function* () { const { plugins: t } = navigator; if (!t) return !1; let n = Object.getPrototypeOf(t) === PluginArray.prototype; for (let e = 0; e < t.length; e++)n && (n = Object.getPrototypeOf(t[e]) === Plugin.prototype); return n })) } function w() { try { null[0]() } catch (t) { return t.stack.toString() } throw new Error("wrong behaviour") } function y() { try { throw "a" } catch (t) { try { return t.toSource(), !0 } catch (n) { return !1 } } } function m() { if (void 0 === navigator.oscpu) throw new Error("navigator.oscpu is undefined"); return navigator.oscpu } function E() { return navigator.platform } function b() { return navigator.productSub } function O() { return navigator.vendor } function P() { if (null == navigator.webdriver) throw new Error("undefined"); return navigator.webdriver } function S() { const t = typeof window.InstallTrigger; if (void 0 === t) throw new Error("undefined"); return "undefined" !== t } function T() { function t() { return performance.now() / 1e3 } function n(t, e) { return t < 1e-8 ? e : t < e ? n(e - Math.floor(e / t) * t, t) : t === e ? t : n(e, t) } const e = t(); let r = t() - e; for (let o = 0; o < 10; o++)r = n(r, t() - e); return Math.round(1 / r) } function j(t, n = []) { return null == Object.getPrototypeOf(t) ? n : j(Object.getPrototypeOf(t), n.concat(Object.getOwnPropertyNames(t))) } function N(t) { return new Promise((n => setTimeout(n, t))) } function k() { return j(window) } function A() { return j(window.document) } function M() { return j(window.navigator) } function x() { return [navigator.maxTouchPoints, navigator.msMaxTouchPoints] } function D() { return [typeof SourceBuffer, typeof SourceBufferList] } function _() { return document.documentElement.getAttributeNames() } function B() { return window.close.toString() } function q() { if (void 0 === window.external) throw new Error("undefined"); return window.external.toString() } function C() { return Object.assign([], navigator.languages) } function R() { return navigator.mimeTypes.length } function I() { return n(this, void 0, void 0, (function* () { const { mimeTypes: t } = navigator; if (!t) return !1; let n = Object.getPrototypeOf(t) === MimeTypeArray.prototype; for (let e = 0; e < t.length; e++)n && (n = Object.getPrototypeOf(t[e]) === MimeType.prototype); return n })) } function U() { return "undefined" != typeof DeviceMotionEvent && "function" == typeof DeviceMotionEvent.requestPermission } function W() { return n(this, void 0, void 0, (function* () { return function (t) { return n(this, void 0, void 0, (function* () { const n = {}; for (const r in t) if (Object.prototype.hasOwnProperty.call(t, r)) { const o = t[r]; n[r] = yield e(o) } return n })) }({ s1: r, s2: o, s3: i, s4: u, s5: s, s6: c, s7: a, s8: d, s9: f, s10: g, s11: h, s12: S, s13: P, s14: l, s15: v, s16: p, s17: w, s18: y, s19: m, s20: E, s21: b, s22: O, s23: T, s24: k, s25: A, s26: M, s27: x, s28: D, s29: _, s30: B, s31: q, s32: C, s33: R, s34: I, s35: U }) })) } class G { constructor(t) { this.mode = null == t.mode ? "requestId" : t.mode, this.endpoint = void 0 === t.endpoint ? "https://botd.fpapi.io/api/v1/" : t.endpoint, this.endpoint.endsWith("/") || (this.endpoint += "/"), this.token = t.token } setTag(t) { if (void 0 !== this.sources) { try { this.tag = void 0 === t ? "" : JSON.stringify(t) } catch (n) { this.tag = "" } this.sources.s36 = { state: 1, value: this.tag } } } collect() { return n(this, void 0, void 0, (function* () { return this.timestamp = Date.now(), this.sources = yield W(), this.performance = Date.now() - this.timestamp, this.sources })) } get(t) { return n(this, void 0, void 0, (function* () { this.setTag(t); const n = { mode: this.mode, timestamp: this.timestamp, performance: this.performance, signals: this.sources, version: "0.1.9", token: this.token }; try { const t = yield fetch(this.endpoint + "detect", { method: "POST", headers: { "Content-Type": "application/json", "Auth-Token": this.token }, body: JSON.stringify(n) }), o = yield t.json(); return e = "botd-request-id", r = o.requestId, r = encodeURIComponent(r), document.cookie = e + "=" + r, o } catch (o) { return { error: { code: 500, message: o.toString() } } } var e, r })) } poll(t = 50, e = 3) { return n(this, void 0, void 0, (function* () { const n = function (t) { const n = document.cookie.match(new RegExp("(?:^|; )" + t.replace(/([.$?*|{}()[\]\\/+^])/g, "\\$1") + "=([^;]*)")); return n ? decodeURIComponent(n[1]) : void 0 }("botd-request-id"); if (null == n) return { error: { code: 400, message: "Call get() method first to make a request" } }; for (; e > 0;)try { const r = yield fetch(this.endpoint + "results?id=" + n, { method: "GET", headers: { "Content-Type": "application/json", "Auth-Token": this.token } }), o = yield r.json(); if ("inProgress" != o.status) return o; if (yield N(t), 0 == --e) return { error: { code: "inProgress", message: "Bot detection result is not ready yet" } } } catch (r) { return { error: { code: "Failed", message: r.toString() } } } return Promise.reject() })) } } var L = { load: function (t) { return n(this, void 0, void 0, (function* () { const n = new G(t); return yield n.collect(), n })) } }; return t.default = L, Object.defineProperty(t, "__esModule", { value: !0 }), t }({});
window.Botd = Botd;
